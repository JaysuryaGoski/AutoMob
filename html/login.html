<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/booking.css">
    <script src="../js/main.js"></script>
    <title>Login | AutoMob-Mechanic</title>
    <script>
        async function validateCredentials() {
            const username = document.getElementById('uname').value;
            const password = document.getElementById('pwd').value;
            const jsonFilePath = '../js/users.json';

            try {
                const response = await fetch(jsonFilePath);
                const data = await response.json();
                if (data.some(user => user.username === username && user.password === password)) {
                    const user = data.find(user => user.username === username && user.password === password);
                    sessionStorage.setItem('userRole', username);
                    sessionStorage.setItem('username', username);
                    alert('Logged in Successfully');
                    window.location.assign('home.html');
                } else {
                    alert("Invalid Username or Password");
                }
            } catch (error) {
                console.error('Error fetching JSON:', error);
            }
        }
    </script>
</head>

<body>
    <header>
        <b><a href="./home.html">AutoMob-Mechanic</a></b>
        <nav>
            <a href="./home.html">Home</a> |
            <a href="./login.html" class="active">Login</a> |
            <a href="mailto:contact@automob.co.in">contact@automob.co.in &#9993;</a> |
            <a>999-999-9999 &#9743;</a>
        </nav>
    </header>
    <main>
        <h2>Login</h2>
        <form>
            <div>
                <label for="uname">Username:</label>
                <input type="text" id="uname" required>
            </div>
            <div>
                <label for="pwd">Password:</label>
                <input type="password" id="pwd" required>
            </div>
            <br>
            <div>
                <input type="button" value="Login" onclick="validateCredentials()">
            </div>
            <br><br>
        </form>
    </main>
    <footer>
        <span>Copyright &copy; 2020 AutoMob-Mechanic.</span>&nbsp;
        <span>All Rights Reserved.</span>
    </footer>
</body>

</html>
